meta:
  version: "v2.0.1"
  author: "Anarion"
units:
  U: 19.05 # 19.05mm MX spacing
  u: 19 # 19mm MX spacing
  cx: 18 # 18mm Choc X spacing
  cy: 17 # 17mm Choc Y spacing
  kx: cx
  ky: cy
  choc1u: 17.5
  choc125u: 22
  choc15u: 26.5
  px: 2
  py: 2
  $default_width: cx
  $default_height: cy
  mcu_cover_height: 43
  mcu_cover_width: 25
  # distance keys to mcu
  mcu_padding: 1.5
  scrollwheel_width: 17
  scrollwheel_height: 14
  screw_diameter: 4.7
  screw_hole: 4.1
  screen_screw_diameter: 4
  screen_screw_hole: 2.2
  switchplate_switch_cutout: 14
  switchplate_scrollwheel_cutout_x: 17.5
  switchplate_scrollwheel_cutout_y: 14.5
  switchplate_screw_diameter: 3.3
  switchplate_screw_hole: 2.2
  trrs_x: 12
  trrs_y: 6
points:
  key:
    padding: ky
  zones:
    matrix:
      anchor:
        shift: [150, -150]
      key:
        tags: [switch1u]
      columns:
        outer:
          key:
            column_net: col_outer
          rows:
            top:
              key.width: choc125u
              tags: [switch125u]
            home:
              key.width: choc125u
              tags: [switch125u]
            bottom:
              key.width: choc125u
              tags: [switch125u]
        pinky:
          key:
            spread: choc1u/2 + choc125u/2 + 1.5
            column_net: col_pinky
        ring:
          key:
            stagger: ky/4
            column_net: col_ring
        middle:
          key:
            stagger: ky/4
            column_net: col_middle
        index:
          key:
            stagger: -ky/4
            column_net: col_index
        inner:
          key:
            stagger: -ky/6
            column_net: col_inner
      rows:
        bottom:
          row_net: row_bottom
          bind: 0.5
        home:
          row_net: row_home
          bind: 0.5
        top:
          row_net: row_top
          bind: 0.5
    thumbfan:
      anchor:
        ref: matrix_index_bottom
        shift: [-0.2kx, -1.5ky]
      columns:
        inner:
          key:
            column_net: col_ring
            splay: 20
            rotate: 90
            # origin: [1 kx, 0]
            width: choc125u
            bind: [0,2,0,2]
          rows:
            thumb:
              tags: [switch125u_thumb]
        near:
          key:
            column_net: col_middle
            splay: -25
            rotate: 90
            # origin: [-0.7 kx, -0.8 ky]
            spread: 1.2kx
            stagger: -0.4ky
            width: choc125u
            bind: [4,0,0,1.5]
          rows:
            thumb:
              tags: [switch125u_thumb]
        home:
          key:
            column_net: col_index
            splay: -15
            rotate: 90
            # origin: [-0.5 kx, -0.7 ky]
            spread: 1.1kx
            stagger: -0.15ky
            width: choc125u
            bind: [2,0,0,1.5]
          rows:
            thumb:
              tags: [switch125u_thumb]
        far:
          key:
            column_net: col_inner
            splay: -15
            rotate: 90
            # origin: [-0.5 kx, -0.9 ky]
            spread: 1.1kx
            stagger: -0.15ky
            width: choc125u
            bind: [2,1.5,0.5,2.5]
          rows:
            thumb:
              tags: [switch125u_thumb]
      rows:
        thumb:
          row_net: row_thumb
      key:
        spread: kx
        tags: [switch1u]
    scrollwheel:
      anchor:
        ref: matrix_inner_bottom
      columns:
        scrollwheel:
          key:
            tags: [scrollwheel]
            shift: [23, -2]
            column_net: col_inner
            width: scrollwheel_width
            height: scrollwheel_height
      rows:
        scrollwheel:
          row_net: row_thumb
    mcu:
      anchor:
        ref: matrix_inner_top
      columns:
        mcu:
          key:
            tags: [mcu]
            width: mcu_cover_height  # footprint width/height unintuitive
            height: mcu_cover_width
            shift: [23, -1]
    trrs:
      anchor:
        ref: [mcu_mcu]
        shift: [mcu_cover_width/2 + trrs_y/2, mcu_cover_height/2 - 3.5]
      columns.trrs.key.tags: [trrs]
    reset:
      anchor:
        ref: [trrs_trrs]
        shift: [0, -18]
      columns.reset.key.tags: [reset]
    screw_top_left:
      anchor:
        ref.aggregate.parts: [matrix_pinky_top, matrix_pinky_home]
        shift: [-(choc1u/2 + choc125u/2 + 1.5)/2, 0]
      columns.screw.key.tags: [screw, break_away_screw]
    screw_bottom_left:
      anchor:
        ref.aggregate.parts: [matrix_pinky_home, matrix_pinky_bottom]
        shift: [-(choc1u/2 + choc125u/2 + 1.5)/2, 0]
      columns.screw.key.tags: [screw, break_away_screw]
    screw_top_left_inner:
      anchor:
        ref.aggregate.parts: [matrix_ring_top, matrix_ring_home]
        shift: [-0.5kx - 0.5, 0]
      columns.screw.key.tags: [screw]
    screw_bottom_left_inner:
      anchor:
        ref.aggregate.parts: [matrix_pinky_bottom, matrix_ring_bottom]
        shift: [0, -0.4ky]
      columns.screw.key.tags: [screw]
    screw_top:
      anchor:
        ref.aggregate.parts: [matrix_index_top, matrix_inner_top]
        shift: [0, -0.1ky]
      columns.screw.key.tags: [screw]
    screw_palm:
      anchor:
        ref.aggregate.parts: [thumbfan_inner_thumb, thumbfan_near_thumb]
      columns.screw.key.tags: [screw]
    screw_top_right:
      anchor:
        ref: [reset_reset]
        shift: [0, -0.5ky]
      columns.screw.key.tags: [screw]
    screw_bottom_right:
      anchor:
        ref: [reset_reset]
        shift: [0, -3ky]
      columns.screw.key.tags: [screw]
    controller_hole_left:
      anchor:
        ref: [mcu_mcu]
        shift: [-mcu_cover_width/2 + 3, -mcu_cover_height/2 - 1.5]
      columns.controller_hole.key.tags: [controller_hole_left]
    controller_hole_right:
      anchor:
        ref: [mcu_mcu]
        shift: [mcu_cover_width/2 - 3, -mcu_cover_height/2 - 1.5]
      columns.controller_hole.key.tags: [controller_hole_right]
outlines:
  # board dimensions according to JLCPCB: 166 mm * 113.7 mm
  break:
    - what: rectangle
      where:
        # ref: matrix_outer_home
        ref.aggregate.parts: [matrix_outer_home, matrix_pinky_home]
        shift: [0,-8]
      size: [1, 14]
      fillet: 0.3
    - what: rectangle
      where:
        # ref: matrix_outer_home
        shift: [0,8]
        ref.aggregate.parts: [matrix_outer_home, matrix_pinky_home]
      size: [1, 14]
      fillet: 0.3
    - what: rectangle
      where:
        # ref: matrix_outer_top
        ref.aggregate.parts: [matrix_outer_top, matrix_pinky_top]
        shift: [0,0.5ky]
      size: [1, 17]
      fillet: 0.3
    - what: rectangle
      where:
        # ref: matrix_outer_bottom
        ref.aggregate.parts: [matrix_outer_bottom, matrix_pinky_bottom]
        shift: [0,-0.5ky]
      size: [1, 17]
      fillet: 0.3
  raw:
    - what: rectangle
      where: [switch1u]
      size: [kx + px, ky + py]
      corner: px
      bound: true
    - what: rectangle
      where: [switch125u]
      size: [1.25kx + px, ky + py]
      corner: px
      bound: true
    - what: rectangle
      where: [switch125u_thumb]
      size: [kx + px, ky + py]
      corner: px
      bound: true
  raw_top_plate:
    - what: rectangle
      where: [switch1u]
      bound: true
      size: [kx + px, ky + py]
      corner: px
    - what: rectangle
      where: [switch125u]
      size: [1.25kx + px, ky + py]
      corner: px
      bound: true
    - what: rectangle
      where: [switch125u_thumb]
      size: [kx + px, ky + py]
      corner: px
      bound: true
  thumbfan_glue:
    - what: polygon
      points:
        - ref: matrix_pinky_home
        - ref: matrix_inner_home
        - ref: matrix_inner_home
          shift: [ 0.62kx , -0.7 ky + 0.5 py]
        - ref: matrix_inner_home
          shift: [2.5kx - px, -0.7 ky + 0.5 py]
        - ref: thumbfan_far_thumb
        - ref: thumbfan_inner_thumb
        - ref: matrix_pinky_bottom
          shift: [1.5 kx + 0.5px,-0.5ky - 1.5]
        - ref: matrix_pinky_bottom
          shift: [0.5 kx + 0.5px,-0.5ky - 1.5]
  controller_area:
    main:
      what: polygon
      points:
        - ref: matrix_middle_top
          shift: [0, 0.5ky + 1.5]
        - ref: matrix_middle_top
          shift: [4.5kx, 0.5ky + 1.5]
        - ref: matrix_middle_top
          shift: [4.5kx, -5ky]
        - ref: matrix_middle_top
          shift: [-2kx, -5.5ky]
        - ref: matrix_pinky_bottom
          shift: [-0.2kx, 0]
      fillet: px
  controller_plate:
    main:
      what: rectangle
      where: [mcu]
      size: [mcu_cover_width, mcu_cover_height]
      adjust:
        shift: [0, -0.3ky]
      corner: px
  controller_plate_holes:
    left:
      what: circle
      where: [controller_hole_left]
      radius: 1.5
    right:
      what: circle
      where: [controller_hole_right]
      radius: 1.5
  reset_hole:
    hole:
      what: circle
      where: [reset]
      radius: 1
  switches:
    - what: rectangle
      where: [switch1u, switch125u, switch125u_thumb]
      size: 14
      bound: false
  keycaps1u:
    - what: rectangle
      where: [switch1u]
      size: [choc1u, choc1u - 1]
      bound: false
      corner: 1
  keycaps15u:
    - what: rectangle
      where: [switch125u]
      size: [choc125u, choc1u - 1] # Choc keycaps are 17.5 x 16.5, 1.25u are 22 x 16.5, 1.5u are 26.5 x 16.5
      bound: false
      corner: 1
  keycaps_thumb15u:
    - what: rectangle
      where: [switch125u_thumb]
      size: [choc125u, choc1u - 1] # Choc keycaps are 17.5 x 16.5, 1.25u are 22 x 16.5, 1.5u are 26.5 x 16.5
      bound: false
      corner: 1
  scrollwheel_cutout:
    - what: rectangle
      where: [scrollwheel]
      size: [switchplate_scrollwheel_cutout_x, switchplate_scrollwheel_cutout_y]
      bound: false
  left_circle:
    main:
      what: circle
      adjust:
        ref: matrix_pinky_bottom
        shift: [-2.5, -73]
      radius: 63
  right_circle:
    main:
      what: circle
      adjust:
        ref: thumbfan_near_thumb
        shift: [-75, 0]
      radius: 63
  keywell:
    main:
      what: outline
      name: raw
    thumbfan_glue:
      what: outline
      name: thumbfan_glue
      operation: add
    break:
      what: outline
      name: break
      operation: subtract
  keywell_top_plate:
    main:
      what: outline
      name: raw_top_plate
    thumbfan_glue2:
      what: outline
      name: thumbfan_glue
      operation: add
  base_outline:
    main:
      what: outline
      name: keywell
    controller:
      what: outline
      name: controller_area
      operation: add
    left_cirlce:
      what: outline
      name: left_circle
      operation: subtract
    right_cirlce:
      what: outline
      name: right_circle
      operation: subtract
  break_away_screw_holes:
    - what: circle
      where: [break_away_screw]
      radius: 0.5switchplate_screw_hole
  screw_holes:
    - what: circle
      where: [screw]
      radius: 0.5switchplate_screw_hole
  cutout:
    main:
      what: outline
      name: base_outline
      fillet: 1
    holes:
      what: outline
      name: break_away_screw_holes
      operation: subtract
  controller_plate_mounting_holes:
    $extends: outlines.controller_plate_holes
    left:
      radius: 2.5
    right:
      radius: 2.5
  controller_plate_with_holes:
    main:
      what: outline
      name: controller_plate
    holes:
      what: outline
      name: controller_plate_holes
      operation: subtract
  bottom_outline:
    main:
      what: outline
      name: cutout
    screw_holes:
      what: outline
      # TODO use footprints with pad + via reinforcement as mounting holes
      name: screw_holes
      operation: subtract
  plate_before_circle:
    main:
      what: outline
      name: keywell_top_plate
  plate:
    main:
      what: outline
      name: plate_before_circle
      fillet: 1
    switches:
      what: outline
      name: switches
      operation: subtract
    mounting_holes:
      what: outline
      # TODO use footprints with pad + via reinforcement as mounting holes
      name: screw_holes
      operation: subtract
  full_with_keycaps:
    main:
      what: outline
      name: keywell
    controller:
      what: outline
      name: controller_area
      operation: add
    keycaps1u:
      what: outline
      name: keycaps1u
      operation: subtract
    keycaps15u:
      what: outline
      name: keycaps15u
      operation: subtract
    keycaps_thumb15u:
      what: outline
      name: keycaps_thumb15u
      operation: subtract
    mounting_holes:
      what: outline
      # TODO use footprints with pad + via reinforcement as mounting holes
      name: screw_holes
      operation: subtract
  preview:
    base_outline:
      what: outline
      name: base_outline
    keycaps1u:
      what: outline
      name: keycaps1u
      operation: subtract
    keycaps15u:
      what: outline
      name: keycaps15u
      operation: subtract
    keycaps_thumb15u:
      what: outline
      name: keycaps_thumb15u
      operation: subtract
  pcb_case:
    main:
      what: outline
      name: cutout
  pcb:
    main:
      what: outline
      name: cutout
  top_plate:
    - raw
    - +thumbfan_glue
    - -break
    - +controller_area
    - -left_circle
    - -right_circle
  top_plate_fillet:
    - what: outline
      name: top_plate
      fillet: 1
  combo:
    - top_plate_fillet
    - -break_away_screw_holes
    # - top_plate_fillet
    # - -switches
    # - -controller_plate
    # - -scrollwheel_cutout
    # - -screw_holes
    # - -reset_hole

pcbs:
  porcupine_top_plate:
    outlines:
      edge:
        outline: combo
        layer: Edge.Cuts
    # Remove this if you'd rather pay more to not have the order number printed at all
    footprints:
      jlc_order_number:
        what: text
        adjust:
          ref.aggregate.parts: [matrix_ring_top, matrix_ring_home]
          shift: [-0.25 kx, 0]
        params:
          text: "JLCJLCJLCJLC"
          justify: left
  porcupine_bottom_plate:
    outlines:
      edge:
        outline: bottom_outline
        layer: Edge.Cuts
    # Remove this if you'd rather pay more to not have the order number printed at all
    footprints:
      jlc_order_number:
        what: text
        adjust:
          ref.aggregate.parts: [matrix_ring_top, matrix_ring_home]
          shift: [-0.25 kx, 0]
        params:
          text: "JLCJLCJLCJLC"
          justify: left
  porcupine:
    outlines:
      edge:
        outline: pcb
        layer: Edge.Cuts
      keys1u:
        outline: keycaps1u
        layer: Eco1.User
      keys15u:
        outline: keycaps15u
        layer: Eco1.User
      keys_thumb15u:
        outline: keycaps_thumb15u
        layer: Eco1.User
      switches_l:
        outline: switches
        layer: F.SilkS
      switches_r:
        outline: switches
        layer: B.SilkS
      top_plate:
        outline: combo
        layer: Eco2.User
      bottom_plate:
        outline: bottom_outline
        layer: Cmts.User
      controller:
        outline: controller_plate_with_holes
        layer: Cmts.User
    footprints:
      choc_hotswap:
        what: choc
        where: [switch1u, switch125u, switch125u_thumb]
        params:
          hotswap: true
          reverse: true
          keycaps: true
          from: "{{colrow}}"
          to: "{{column_net}}"
      diode:
        what: diode
        where: [switch1u, switch125u, switch125u_thumb]
        params:
          reverse: true
          from: "{{colrow}}"
          to: "{{row_net}}"
        adjust:
          shift: [0, -5]
      mcu:
        what: promicro_pretty
        where: [mcu]
        params:
          orientation: up
          RAW: RAW
          GND: GND
          RST: RST
          VCC: VCC
          P21: ENCB
          P20: ENCA
          P19: col_outer
          P18: col_pinky
          P15: col_ring
          P14: col_middle
          P16: col_index
          P10: col_inner
          P1: CS
          P0: trrs
          P2: SDA
          P3: SCL
          P4: row_top
          P5: row_home
          P6: row_bottom
          P7: row_thumb
          P8: P8
          P9: P9
        adjust:
          rotate: 270
      niceview:
        what: niceview
        where: [mcu_mcu]
        adjust:
          shift: [0, -1.1ky]
          rotate: 90
        params:
          outline: true
          side: 'F'
          SDA: SDA
          SCL: SCL
          VCC: VCC
          GND: GND
          CS: CS
      scrollwheel_vertical:
        what: scrollwheel_mirrored
        where: [scrollwheel]
        params:
          from: "{{column_net}}"
          to: "{{colrow}}"
          A: ENCB
          B: GND
          C: ENCA
          D: undef
      # scrollwheel_horizontal:
      #   what: scrollwheel_mirrored
      #   where: [scrollwheel]
      #   adjust:
      #   #   ref:
      #   #     - matrix_inner_bottom
      #     shift: [3, -3]
      #     rotate: -90
      #   params:
      #     from: "{{column_net}}"
      #     to: "{{colrow}}"
      #     A: ENCB
      #     B: GND
      #     C: ENCA
      #     D: undef
      scroll_diode:
        what: diode
        where: [scrollwheel]
        params:
          reverse: true
          from: "{{colrow}}"
          to: "{{row_net}}"
        adjust:
          shift: [1, -11]
          rotate: 0
      jlc_order_number:
        what: text
        adjust:
          ref.aggregate.parts: [matrix_ring_top, matrix_ring_home]
          shift: [-0.25 kx, 0]
        params:
          text: "JLCJLCJLCJLC"
          justify: left
      bat:
        what: bat2p0
        adjust:
          ref: matrix_inner_top
          shift: [-2.5, 13.5]
          rotate: 0
        params:
          front: true
          back: true
          neg: GND
          pos: Bplus
      pad_plus:
        what: pad
        adjust:
          ref:
            - matrix_inner_top
          shift: [1, 12.5]
          rotate: 0
        params:
          front: true
          back: true
          width: 1.5
          height: 1.5
          align: "right"
          text: "Bplus"
          net: Bplus
      pad_minus:
        what: pad
        adjust:
          ref:
            - matrix_inner_top
          shift: [1, 14.5]
          rotate: 0
        params:
          front: true
          back: true
          width: 1.5
          height: 1.5
          align: "right"
          text: "GND"
          net: GND
      trrs:
        what: trrs
        where: [trrs]
        adjust:
          rotate: 0
        params:
          reverse: true
          symmetric: true
          A: VCC
          B: VCC
          C: GND
          D: trrs
      jumper_l:
        what: jumper
        adjust:
          ref:
            - matrix_inner_top
          shift: [-11, 14]
          rotate: 90
        params:
          side: B
          from: Bplus
          to: RAW
      jumper_r:
        what: jumper
        adjust:
          ref:
            - matrix_inner_top
          shift: [-11, 14]
          rotate: 90
        params:
          side: F
          from: Bplus
          to: RAW
      pcm12:
        what: pcm12
        adjust:
          ref: matrix_index_top
          shift: [0, 12.1]
          rotate: 180
        params:
          reverse: true
          from: RAW
          to: Bplus
      reset:
        what: b3u1000p
        where: [reset]
        params:
          reverse: true
          r1: RST
          r2: GND
      porcupine_l:
        what: porcupine_new
        adjust:
          ref:
            - matrix_middle_bottom
          shift: [-0.3kx, -1.25ky]
          rotate: -30
        params:
          side: F
      porcupine_r:
        what: porcupine_new
        adjust:
          ref:
            - matrix_middle_bottom
          shift: [-0.3kx, -1.25ky]
          rotate: -30
        params:
          side: B
      info_l:
        what: text
        where: [reset_reset]
        adjust:
          # ref:
          #   - thumbfan_near_thumb
          rotate: 90
          shift: [0.15kx, -2.5ky]
        params:
          layer: F.SilkS
          text: "porcupine v2.0 by AnarioN"
          justify: left
      info_r:
        what: text
        where: [reset_reset]
        adjust:
        #   ref:
        #     - thumbfan_near_thumb
          rotate: 90
          shift: [0.15kx, -1.3ky]
        params:
          layer: B.SilkS
          text: "porcupine v2.0 by AnarioN"
          justify: left mirror
      tenting_puck:
        what: tentingpuck
        adjust:
          ref.aggregate.parts: [matrix_middle_home, matrix_index_home]
          shift: [0, -0.35ky]
        params:
          reverseSilks: false
      side_l:
        what: sideindicator
        adjust:
          ref:
            - matrix_index_bottom
          shift: [0.4kx, -ky]
        params:
          side: F
      side_r:
        what: sideindicator
        adjust:
          ref:
            - matrix_index_bottom
          shift: [0.4kx, -ky]
        params:
          side: B
      mcu_solder_l:
        what: text
        where: [mcu_mcu]
        adjust:
          shift: [-0.2kx, -0.4ky]
          rotate: 90
        params:
          text: "Solder the jumpers,"
          style: italic
          justify: left
      mcu_solder_r:
        what: text
        where: [mcu_mcu]
        adjust:
          shift: [-0.2kx, 0.4ky]
          rotate: 90
        params:
          layer: B.SilkS
          text: "Solder the jumpers,"
          style: italic
          justify: left mirror
      mcu_info_l:
        what: text
        where: [mcu_mcu]
        adjust:
          shift: [0.2kx, -0.6ky]
          rotate: 90
        params:
          text: "and place MCU facing UP!"
          style: italic
          justify: left
      mcu_info_r:
        what: text
        where: [mcu_mcu]
        adjust:
          shift: [0.2kx, 0.6ky]
          rotate: 90
        params:
          layer: B.SilkS
          text: "and place MCU facing UP!"
          style: italic
          justify: left mirror
      # via_GND_2:
      #   what: simple_via
      #   adjust:
      #     ref: matrix_ring_top
      #     shift: [11,3]
      #   params:
      #     net: GND
      # via_GND_3:
      #   what: simple_via
      #   adjust:
      #     ref: matrix_ring_top
      #     shift: [12,-3]
      #   params:
      #     net: GND
      via_GND_5:
        what: simple_via
        adjust:
          ref: matrix_inner_top
          shift: [-3,-2]
        params:
          net: GND
      via_GND_6:
        what: simple_via
        adjust:
          ref: matrix_inner_home
          shift: [-6,-2]
        params:
          net: GND
      via_GND_7:
        what: simple_via
        adjust:
          ref: matrix_inner_bottom
          shift: [-3,-2.5]
        params:
          net: GND
      via_GND_8:
        what: simple_via
        adjust:
          ref: matrix_inner_bottom
          shift: [5,-2.5]
        params:
          net: GND
      via_GND_9:
        what: simple_via
        adjust:
          ref: matrix_inner_bottom
          shift: [9.5,-2]
        params:
          net: GND
      via_col_pinky_1:
        what: simple_via
        adjust:
          ref: matrix_pinky_top
          shift: [0,3]
        params:
          net: col_pinky
      via_pinky_top:
        what: simple_via
        adjust:
          ref: matrix_pinky_top
          shift: [0,8.5]
        params:
          net: pinky_top
      via_col_pinky_2:
        what: simple_via
        adjust:
          ref: matrix_pinky_home
          shift: [0,3]
        params:
          net: col_pinky
      via_pinky_home:
        what: simple_via
        adjust:
          ref: matrix_pinky_home
          shift: [0,8.5]
        params:
          net: pinky_home
      via_col_pinky_3:
        what: simple_via
        adjust:
          ref: matrix_pinky_bottom
          shift: [0,3]
        params:
          net: col_pinky
      via_pinky_bottom:
        what: simple_via
        adjust:
          ref: matrix_pinky_bottom
          shift: [0,8.5]
        params:
          net: pinky_bottom
      via_col_ring_1:
        what: simple_via
        adjust:
          ref: matrix_ring_top
          shift: [0,3]
        params:
          net: col_ring
      via_ring_top:
        what: simple_via
        adjust:
          ref: matrix_ring_top
          shift: [0,8.5]
        params:
          net: ring_top
      via_col_ring_2:
        what: simple_via
        adjust:
          ref: matrix_ring_home
          shift: [0,3]
        params:
          net: col_ring
      via_ring_home:
        what: simple_via
        adjust:
          ref: matrix_ring_home
          shift: [0,8.5]
        params:
          net: ring_home
      via_col_ring_3:
        what: simple_via
        adjust:
          ref: matrix_ring_bottom
          shift: [0,3]
        params:
          net: col_ring
      via_ring_bottom:
        what: simple_via
        adjust:
          ref: matrix_ring_bottom
          shift: [0,8.5]
        params:
          net: ring_bottom
      via_col_middle_1:
        what: simple_via
        adjust:
          ref: matrix_middle_top
          shift: [0,3]
        params:
          net: col_middle
      via_middle_top:
        what: simple_via
        adjust:
          ref: matrix_middle_top
          shift: [0,8.5]
        params:
          net: middle_top
      via_col_middle_2:
        what: simple_via
        adjust:
          ref: matrix_middle_home
          shift: [0,3]
        params:
          net: col_middle
      via_middle_home:
        what: simple_via
        adjust:
          ref: matrix_middle_home
          shift: [0,8.5]
        params:
          net: middle_home
      via_col_middle_3:
        what: simple_via
        adjust:
          ref: matrix_middle_bottom
          shift: [0,3]
        params:
          net: col_middle
      via_middle_bottom:
        what: simple_via
        adjust:
          ref: matrix_middle_bottom
          shift: [0,8.5]
        params:
          net: middle_bottom
      via_col_index_1:
        what: simple_via
        adjust:
          ref: matrix_index_top
          shift: [0,3]
        params:
          net: col_index
      via_index_top:
        what: simple_via
        adjust:
          ref: matrix_index_top
          shift: [0,8.5]
        params:
          net: index_top
      via_col_index_2:
        what: simple_via
        adjust:
          ref: matrix_index_home
          shift: [0,3]
        params:
          net: col_index
      via_index_home:
        what: simple_via
        adjust:
          ref: matrix_index_home
          shift: [0,8.5]
        params:
          net: index_home
      via_col_index_3:
        what: simple_via
        adjust:
          ref: matrix_index_bottom
          shift: [0,3]
        params:
          net: col_index
      via_index_bottom:
        what: simple_via
        adjust:
          ref: matrix_index_bottom
          shift: [0,8.5]
        params:
          net: index_bottom
      via_col_inner_1:
        what: simple_via
        adjust:
          ref: matrix_inner_top
          shift: [0,3]
        params:
          net: col_inner
      via_inner_top:
        what: simple_via
        adjust:
          ref: matrix_inner_top
          shift: [0,8.5]
        params:
          net: inner_top
      via_col_inner_2:
        what: simple_via
        adjust:
          ref: matrix_inner_home
          shift: [0,3]
        params:
          net: col_inner
      via_inner_home:
        what: simple_via
        adjust:
          ref: matrix_inner_home
          shift: [0,8.5]
        params:
          net: inner_home
      via_col_inner_3:
        what: simple_via
        adjust:
          ref: matrix_inner_bottom
          shift: [0,3]
        params:
          net: col_inner
      via_inner_bottom:
        what: simple_via
        adjust:
          ref: matrix_inner_bottom
          shift: [0,8.5]
        params:
          net: inner_bottom
      via_18_4:
        what: simple_via
        adjust:
          ref: thumbfan_near_thumb
          shift: [0,3]
        params:
          net: col_middle
      via_near_thumb:
        what: simple_via
        adjust:
          ref: thumbfan_near_thumb
          shift: [0,8.5]
        params:
          net: near_thumb
      via_15_4:
        what: simple_via
        adjust:
          ref: thumbfan_home_thumb
          shift: [0,3]
        params:
          net: col_index
      via_home_thumb:
        what: simple_via
        adjust:
          ref: thumbfan_home_thumb
          shift: [0,8.5]
        params:
          net: home_thumb
      via_14_4:
        what: simple_via
        adjust:
          ref: thumbfan_far_thumb
          shift: [0,3]
        params:
          net: col_inner
      via_far_thumb:
        what: simple_via
        adjust:
          ref: thumbfan_far_thumb
          shift: [0,8.5]
        params:
          net: far_thumb
      via_col_ring_4:
        what: simple_via
        adjust:
          ref: thumbfan_inner_thumb
          shift: [0,3]
        params:
          net: col_ring
      via_inner_thumb:
        what: simple_via
        adjust:
          ref: thumbfan_inner_thumb
          shift: [0,8.5]
        params:
          net: inner_thumb
      via_col_outer_1:
        what: simple_via
        adjust:
          ref: matrix_outer_top
          shift: [0,3]
        params:
          net: col_outer
      via_outer_top:
        what: simple_via
        adjust:
          ref: matrix_outer_top
          shift: [0,8.5]
        params:
          net: outer_top
      via_col_outer_2:
        what: simple_via
        adjust:
          ref: matrix_outer_home
          shift: [0,3]
        params:
          net: col_outer
      via_outer_home:
        what: simple_via
        adjust:
          ref: matrix_outer_home
          shift: [0,8.5]
        params:
          net: outer_home
      via_col_outer_3:
        what: simple_via
        adjust:
          ref: matrix_outer_bottom
          shift: [0,3]
        params:
          net: col_outer
      via_outer_bottom:
        what: simple_via
        adjust:
          ref: matrix_outer_bottom
          shift: [0,8.5]
        params:
          net: outer_bottom
      zone_l:
        what: zone
        params:
          net: GND
          side: F
          points: [[330, 230], [100, 230], [100, 50], [330, 50]]
      zone_r:
        what: zone
        params:
          net: GND
          side: B
          points: [[330, 230], [100, 230], [100, 50], [330, 50]]
      hole_controller_1:
        what: through_hole
        adjust:
          ref: matrix_inner_home
          shift: [13.5, -7]
        params:
          size: 4.4
          drill: 2.2
      hole_controller_2:
        what: through_hole
        adjust:
          ref: matrix_inner_home
          shift: [32.5, -7]
        params:
          size: 4.4
          drill: 2.2
      mounting_holes:
        what: through_hole
        where: [screw]
        params:
          size: 4.4
          drill: 2.3
cases:
  case:
    - what: outline
      name: pcb_case
      operation: add
      extrude: 1
  bottom_plate:
    - what: outline
      name: bottom_outline
      operation: add
      extrude: 1
  top_plate:
    - what: outline
      name: plate
      operation: add
      extrude: 1
